<!DOCTYPE html>

<head>
    <title>FullHousie</title>
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    
</head>

<body class="yayy">
    <center>
        <div class="tambola">
                FULL-HOUSIE
        </div>
    </center>
    <div class="flexb">
        <div class="item-1">
            <div class="ticket1 gridtkt">

                <% function generateNumber() { %>
                <%  let nums = [0, 1, 2, 3, 4, 5, 6, 7, 8]; %>
                <% let ranNums = []; %>
                <%  let x = nums.length; %>
                <%  let k = 0; %>
                <% let count = 5; %>
                <%  while (x-- && count > 0) {  %>
                <% k = Math.floor(Math.random() * (x + 1)); %>
                <%  ranNums.push(nums[k]); %>
                <% nums.splice(k, 1); %>
                <%  count--;%>
                <%   } %>
                <%y = ranNums.sort();%>
                <% return y;%>
                <% } %>



                <% var chunked = [[0,0,0,0,0,0,0,0,0], [0,0,0,0,0,0,0,0,0], [0,0,0,0,0,0,0,0,0]]; %>
                <% for(let i = 0; i < chunked.length; i++) { %>
                <%  let a = generateNumber(); %>
                <%   for(let j = 0; j < chunked[i].length; j++) { %>
                <%  let x = a.shift(); %>
                <%  let y = Math.floor((Math.random() * 90) + 1); %>
                <%  if(j == x) { %>
                <%  chunked[i][j] = y; %>
                <div class="t1 xyz1"><%- y %></div>
                <% } else { %>
                <%   a.unshift(x); %>
                <div class="t1">O</div>
                <%   continue; %>
                <%  } %>
                <%  }  %>
                <% } %>


            </div>
            <div class="tckt">Ticket P-1</div>
        </div>
        <div class="item-2 grid">
            <div class="cell" data-key="1">1</div>
            <div class="cell" data-key="2">2</div>
            <div class="cell" data-key="3">3</div>
            <div class="cell" data-key="4">4</div>
            <div class="cell" data-key="5">5</div>
            <div class="cell" data-key="6">6</div>
            <div class="cell" data-key="7">7</div>
            <div class="cell" data-key="8">8</div>
            <div class="cell" data-key="9">9</div>
            <div class="cell" data-key="10">10</div>



            <div class="cell" data-key="11">11</div>
            <div class="cell" data-key="12">12</div>
            <div class="cell" data-key="13">13</div>
            <div class="cell" data-key="14">14</div>
            <div class="cell" data-key="15">15</div>
            <div class="cell" data-key="16">16</div>
            <div class="cell" data-key="17">17</div>
            <div class="cell" data-key="18">18</div>
            <div class="cell" data-key="19">19</div>
            <div class="cell" data-key="20">20</div>


            <div class="cell" data-key="21">21</div>
            <div class="cell" data-key="22">22</div>
            <div class="cell" data-key="23">23</div>
            <div class="cell" data-key="24">24</div>
            <div class="cell" data-key="25">25</div>
            <div class="cell" data-key="26">26</div>
            <div class="cell" data-key="27">27</div>
            <div class="cell" data-key="28">28</div>
            <div class="cell" data-key="29">29</div>
            <div class="cell" data-key="30">30</div>


            <div class="cell" data-key="31">31</div>
            <div class="cell" data-key="32">32</div>
            <div class="cell" data-key="33">33</div>
            <div class="cell" data-key="34">34</div>
            <div class="cell" data-key="35">35</div>
            <div class="cell" data-key="36">36</div>
            <div class="cell" data-key="37">37</div>
            <div class="cell" data-key="38">38</div>
            <div class="cell" data-key="39">39</div>
            <div class="cell" data-key="40">40</div>


            <div class="cell" data-key="41">41</div>
            <div class="cell" data-key="42">42</div>
            <div class="cell" data-key="43">43</div>
            <div class="cell" data-key="44">44</div>
            <div class="cell" data-key="45">45</div>
            <div class="cell" data-key="46">46</div>
            <div class="cell" data-key="47">47</div>
            <div class="cell" data-key="48">48</div>
            <div class="cell" data-key="49">49</div>
            <div class="cell" data-key="50">50</div>


            <div class="cell" data-key="51">51</div>
            <div class="cell" data-key="52">52</div>
            <div class="cell" data-key="53">53</div>
            <div class="cell" data-key="54">54</div>
            <div class="cell" data-key="55">55</div>
            <div class="cell" data-key="56">56</div>
            <div class="cell" data-key="57">57</div>
            <div class="cell" data-key="58">58</div>
            <div class="cell" data-key="59">59</div>
            <div class="cell" data-key="60">60</div>


            <div class="cell" data-key="61">61</div>
            <div class="cell" data-key="62">62</div>
            <div class="cell" data-key="63">63</div>
            <div class="cell" data-key="64">64</div>
            <div class="cell" data-key="65">65</div>
            <div class="cell" data-key="66">66</div>
            <div class="cell" data-key="67">67</div>
            <div class="cell" data-key="68">68</div>
            <div class="cell" data-key="69">69</div>
            <div class="cell" data-key="70">70</div>


            <div class="cell" data-key="71">71</div>
            <div class="cell" data-key="72">72</div>
            <div class="cell" data-key="73">73</div>
            <div class="cell" data-key="74">74</div>
            <div class="cell" data-key="75">75</div>
            <div class="cell" data-key="76">76</div>
            <div class="cell" data-key="77">77</div>
            <div class="cell" data-key="78">78</div>
            <div class="cell" data-key="79">79</div>
            <div class="cell" data-key="80">80</div>


            <div class="cell" data-key="81">81</div>
            <div class="cell" data-key="82">82</div>
            <div class="cell" data-key="83">83</div>
            <div class="cell" data-key="84">84</div>
            <div class="cell" data-key="85">85</div>
            <div class="cell" data-key="86">86</div>
            <div class="cell" data-key="87">87</div>
            <div class="cell" data-key="88">88</div>
            <div class="cell" data-key="89">89</div>
            <div class="cell" data-key="90">90</div>
        </div>

        <div class="item-2">

            <div class="ticket2 gridtkt">

                <% var chunked2 = [[0,0,0,0,0,0,0,0,0], [0,0,0,0,0,0,0,0,0], [0,0,0,0,0,0,0,0,0]]; %>

                <% for(let i = 0; i < chunked2.length; i++) { %>
                <%  let a = generateNumber(); %>
                <%   for(let j = 0; j < chunked2[i].length; j++) { %>
                <%  let x = a.shift(); %>
                <%  let y = Math.floor((Math.random() * 90) + 1); %>
                <%  if(j == x) { %>
                <%  chunked2[i][j] = y; %>
                <div class="t1 xyz2"><%- y %></div>
                <% } else { %>
                <%   a.unshift(x); %>
                <div class="t1">O</div>
                <%   continue; %>
                <%  } %>
                <%  }  %>
                <% } %>

            </div>

            <div class="tckt">Ticket P-2</div>
        </div>











    </div>
    <button type="submit" class="button">New Number</button>

    <script>
        var button = document.querySelector(".button");
        const keys = document.querySelectorAll("[data-key]");
        const div = document.querySelectorAll(".cell");
        const tick2 = document.querySelectorAll(".xyz2");
        const tick1 = document.querySelectorAll(".xyz1");



        let array = [];

        keys.forEach(key => {
            array.push(key);
        });
        let arr1 = [];
        tick1.forEach(key => {
            arr1.push(key.innerText);
        });
        let arr2 = [];
        tick2.forEach(key => {
            arr2.push(key.innerText);
        });

        //-----------------------------------------------Generate New Number ---------------------------------------
        var x = 0;
        let countForPlayer1 = 0;
        let countForPlayer2 = 0;
        let i = 0;
        let arr = [0, 0];

        function Ticket1(arr, num) {
            let count = 0;
            for (let j = 0; j < arr.length; j++) {
                if (num == arr[j]) {
                    console.log("Match found 1");
                    tick1.forEach(key => {
                        if(key.innerText == num == arr[j]) {
                            key.classList.add(".findThenumber");
                        }
                    });
                    count++;
                }
            }
            return count;
        }

        function Ticket2(arr, num) {
            let count = 0;
            for (let j = 0; j < arr.length; j++) {
                if (num == arr[j]) {
                    console.log("Match found 2");
                    tick2.forEach(key => {
                        if(key.innerText == num == arr[j]) {
                            key.classList.add(".findThenumber");
                        }
                    });
                    count++;
                }
            }
            return count;
        }




        function generateNumber() {
            div.forEach(key => {
                x = Math.floor((Math.random() * 90) + 1);
                if (x == key.innerText) {
                    key.classList.add("findThenumber");
                }
            })

            Winner(x);

        }



        //------------------------------------------------------Winner-----------------------------------------------------------





function Winner() {
        while (i == 0) {
            countForPlayer1 += Ticket1(arr1, x);
            countForPlayer2 += Ticket2(arr2, x);

            arr[0] = countForPlayer1;
            arr[1] = countForPlayer2;

            while (arr[0] == 15 || arr[1] == 15) {
                if (arr[0] == 15) {
                    console.log("Player 1 Won");
                    document.querySelector(".tambola").innerText="Player 1 Wins!!" 
                    document.querySelector(".tambola").classList.add("winner") 
                    i = 1;
                    break;
                } else {
                    console.log("Player 2 Won");
                    document.querySelector(".tambola").innerText="Player 2 Wins!!" 
                    document.querySelector(".tambola").classList.add("winner") 
                    i = 1;
                    break;
                }
            }
            break;
     }
}
        

    button.addEventListener("click", generateNumber);
    button.addEventListener("click", Winner);

    </script>

</body>